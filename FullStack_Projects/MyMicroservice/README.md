é¡¹ç›®ä»‹ç»ï¼š

    æœ¬é¡¹ç›®æ˜¯ä¸€ä¸ª é¢å‘ç”µå•†åœºæ™¯çš„å…¨æ ˆå¾®æœåŠ¡å®æˆ˜é¡¹ç›®
    æ¶µç›–å•†å“ç®¡ç†ã€è´­ç‰©è½¦ã€è®¢å•æäº¤ä¸æŠ˜æ‰£ç­–ç•¥ç­‰æ ¸å¿ƒæ¨¡å—ï¼Œæ”¯æŒå•†å®¶å¤šè§’è‰²ä½¿ç”¨ã€‚
    æ˜¯ä¸€ä¸ªå…¸å‹çš„Saasé¡¹ç›®software as a service

    å› ä¸ºç”¨å•ä½“çš„è¯ï¼Œéƒ¨ç½²éš¾ï¼Œæ‰©å±•æ€§èƒ½å·®ï¼Œç»´æŠ¤å›°éš¾ï¼ŒæŠ€æœ¯æ ˆä¸çµæ´»
    ä½†æ˜¯ä¼ ç»Ÿå•ä½“è¿˜æ˜¯ç”¨åœ¨MVPä¸Šï¼Œåˆåˆ›å›¢é˜Ÿï¼Œæˆ–è€…å°è§„æ¨¡çš„ç³»ç»Ÿï¼Œä»¥åŠé¢„ç®—æœ‰é™å˜åŠ¨æœ‰é™çš„ç³»ç»Ÿã€‚


é‡‡ç”¨çš„æŠ€æœ¯ï¼š

    ç”±äºå½“å‰é¡¹ç›®å…·æœ‰æŒç»­è¿­ä»£ã€çµæ´»æ‰©å±•ã€è§’è‰²å¤šæ ·ç­‰ç‰¹ç‚¹ï¼Œ
    å› æ­¤é‡‡ç”¨ SaaS åŒ–çš„å¾®æœåŠ¡æ¶æ„æ›´åŠ å¥‘åˆï¼Œèƒ½å¤Ÿå®ç°æœåŠ¡è§£è€¦ã€ç‹¬ç«‹éƒ¨ç½²ã€æ¨¡å—å¼¹æ€§æ‰©å±•ï¼Œ
    å¹¶ä¸ºæœªæ¥çš„å¤šç§Ÿæˆ·ä¸äº‘åŸç”Ÿéƒ¨ç½²æ‰“ä¸‹åŸºç¡€ã€‚

å…·ä½“çš„æŠ€æœ¯å¯¨ï¼š
    å‰ç«¯
    åæ®µ ASP.NET Core Web API å¯é€‰çš„åˆ«çš„  Node.jsã€Spring Bootã€Go
        ASP.NET Core ç‰¹åˆ«é€‚åˆ ä¸­å¤§å‹ç³»ç»Ÿæˆ–ä¼ä¸šçº§ SaaS å¹³å°ï¼Œå®ƒå…·æœ‰é«˜æ€§èƒ½ã€è‰¯å¥½çš„å·¥ç¨‹è§„èŒƒã€å¼ºç”Ÿæ€æ”¯æŒï¼ˆå¦‚ EF Coreã€Identityã€gRPCï¼‰ï¼Œéå¸¸é€‚åˆéœ€è¦é•¿æœŸç»´æŠ¤ã€å¯æ‰©å±•æ€§å¼ºã€éƒ¨ç½²å®‰å…¨æ€§é«˜çš„é¡¹ç›®ã€‚
        Node.js é€‚åˆæ„å»ºè½»é‡çº§ã€å¿«é€Ÿè¿­ä»£çš„é¡¹ç›®ï¼ŒSpring Boot é€‚ç”¨äºé‡‘èã€ç”µä¿¡ç­‰ Java æŠ€æœ¯æ ˆæˆç†Ÿçš„å¤§å‹å›¢é˜Ÿï¼ŒGo åˆ™é€‚åˆé«˜å¹¶å‘ã€ä½å»¶è¿ŸæœåŠ¡ï¼ˆå¦‚ API ç½‘å…³ã€å¾®æœåŠ¡é€šä¿¡ã€æ—¥å¿—ç³»ç»Ÿç­‰ï¼‰ã€‚
    æ•°æ®åº“ PostgreSQL + EF Core å¯é€‰çš„åˆ«çš„ MySQLã€SQL Serverã€MongoDB
        ç”¨PostgreSQLæ˜¯å› ä¸ºï¼Œä¸‹å•ç‰µæ‰¯åˆ°äº†å¤šæ–¹çš„æ•°æ®ï¼Œæ‰€ä»¥ä¼šæ¶‰åŠåˆ°äº‹åŠ¡ã€‚
        ç›®å‰ç”¨PostgreSQLå¾ˆå¥½çš„æ”¯æŒå•¦äº‹åŠ¡ã€‚


ğŸ§© æ¶æ„æ¨¡å¼
å¾®æœåŠ¡æ¶æ„ï¼ˆ.NETï¼‰ï¼ˆå•ä½“æ¶æ„ï¼Œåˆ†å±‚æ¶æ„ï¼Œå¾®æœåŠ¡æ¶æ„ï¼Œäº‹ä»¶é©±åŠ¨æ¶æ„ï¼‰
    æ‹†åˆ†åŠŸèƒ½æœåŠ¡ï¼Œæå‡æ‰©å±•æ€§ä¸å¯ç»´æŠ¤æ€§
    æ”¯æŒæœåŠ¡è§£è€¦ã€ç‹¬ç«‹éƒ¨ç½²ã€å›¢é˜Ÿåä½œ
âš™ï¸ åç«¯æ¡†æ¶ï¼ˆSpring Boot, Express.js, Go, Node.jsï¼‰
ASP.NET Core Web API
    æ„å»º RESTful å¾®æœåŠ¡
    æ€§èƒ½å¥½ã€ç”Ÿæ€æˆç†Ÿã€é€‚åˆä¼ä¸šçº§æœåŠ¡
ğŸ—ƒ æ•°æ®åº“
PostgreSQL + EF Core
    å„æœåŠ¡ç‹¬ç«‹æ•°æ®åº“ + ORM ç®¡ç†
    PostgreSQL ç¨³å®šå¼€æºï¼›EF Core æé«˜å¼€å‘æ•ˆç‡
ğŸ“¦ å®¹å™¨åŒ–
Docker
    å°è£…æœåŠ¡ï¼Œç»Ÿä¸€éƒ¨ç½²
    ä¿è¯è¿è¡Œç¯å¢ƒä¸€è‡´ï¼Œæ”¯æŒå¿«é€Ÿæ‰©å®¹
ğŸ”„ æœåŠ¡æ³¨å†Œ / ç½‘å…³
API Gatewayï¼ˆOcelot / BFFï¼‰
    èšåˆå¤šä¸ªæœåŠ¡å…¥å£
    å®ç°ç»Ÿä¸€è®¿é—®æ§åˆ¶ã€è´Ÿè½½å‡è¡¡ã€è·¯ç”±è½¬å‘
ğŸ“¤ æœåŠ¡é€šä¿¡ï¼ˆå¯æ‰©å±•ï¼‰
REST API / å¯æ¥å…¥ gRPC / RabbitMQ
    æœåŠ¡ä¹‹é—´é€šä¿¡ / å¼‚æ­¥è§£è€¦
    æ”¯æŒå¤šåè®®ï¼Œä¾¿äºæ°´å¹³æ‰©å±•ä¸é«˜å¹¶å‘
ğŸ“‹ é…ç½®ç®¡ç†
appsettings.json + DI
    ç®¡ç†è¿æ¥ä¸²ã€æœåŠ¡é…ç½®ç­‰
    é…åˆä¾èµ–æ³¨å…¥æ”¯æŒçµæ´»é…ç½®
ğŸ“ˆ æ¥å£æµ‹è¯•
Swagger
    æ¥å£æ–‡æ¡£ + åœ¨çº¿æµ‹è¯•
    å¼€å‘æœŸé—´å¿«é€ŸéªŒè¯ API
ğŸ” è‡ªåŠ¨åŒ–éƒ¨ç½²ï¼ˆå¯æ‰©å±•ï¼‰
Docker Compose
    ä¸€é”®éƒ¨ç½²å¤šæœåŠ¡



æ¯ä¸ªå¾®æœåŠ¡çš„åŠŸèƒ½
    Catalog
        â€¢	ç®¡ç†å•†å“ç›®å½•ï¼ˆCRUDï¼‰
        â€¢	è´Ÿè´£å•†å“çš„å±•ç¤ºã€ä¸Šæ¶ã€ä¸‹æ¶ã€ä»·æ ¼æè¿°ç­‰
        â€¢	æä¾› /api/products ç›¸å…³æ¥å£
        â€¢	è¿æ¥ PostgreSQLï¼Œé€šè¿‡ EF Core ç®¡ç†æ•°æ®
        â€¢	ä¾› Basketã€Ordering ç­‰æœåŠ¡æŸ¥è¯¢å•†å“ä¿¡æ¯
    Basket
        â€¢	ç®¡ç†ç”¨æˆ·çš„è´­ç‰©è½¦ï¼ˆæ¯ä¸ªç”¨æˆ·ä¸€ä¸ªè´­ç‰©è½¦ï¼‰
        â€¢	æä¾›æ·»åŠ å•†å“ã€åˆ é™¤å•†å“ã€æ¸…ç©ºè´­ç‰©è½¦ã€æ›´æ–°æ•°é‡ã€æŸ¥çœ‹
        â€¢	ä¸€èˆ¬ä¼šå°†è´­ç‰©è½¦ä¿¡æ¯ä¿å­˜åœ¨ Redis ä¸­ï¼ˆé«˜æ€§èƒ½ã€ä½å»¶è¿Ÿï¼‰
        â€¢	å¯¹æ¥ Catalog æœåŠ¡è·å–å•†å“ä¿¡æ¯ï¼ˆå¦‚ä»·æ ¼å’Œåç§°ï¼‰
    DIscount
        â€¢	æä¾›ä¼˜æƒ åˆ¸ï¼ˆCouponï¼‰ç³»ç»Ÿæˆ–æŠ˜æ‰£ç­–ç•¥
        â€¢	å­˜å‚¨æ¯ä¸ªå•†å“æˆ–ç”¨æˆ·å¯ä½¿ç”¨çš„æŠ˜æ‰£
        â€¢	é€šå¸¸ä½¿ç”¨ gRPC æˆ– REST æä¾›æ¥å£
        â€¢	è¢« Basket / Ordering åœ¨ç»“ç®—æ—¶è°ƒç”¨
    Ordering
        â€¢	å¤„ç†ä¸‹å•æµç¨‹ï¼ŒåŒ…æ‹¬ä»è´­ç‰©è½¦ç”Ÿæˆè®¢å•
        â€¢	å­˜å‚¨è®¢å•è®°å½•ï¼ˆè®¢å•å·ã€ç”¨æˆ·ã€å•†å“æ¸…å•ã€é‡‘é¢ã€çŠ¶æ€ç­‰ï¼‰
        â€¢	å¯ä»¥åŒ…å«è®¢å•çŠ¶æ€æµè½¬ï¼ˆæ–°å»ºã€å·²æ”¯ä»˜ã€å·²å‘è´§ç­‰ï¼‰
        â€¢	è®¢å•æ•°æ®ä¸€èˆ¬å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼ˆå¦‚ PostgreSQLï¼‰
        â€¢	ä¸‹å•æ—¶ä¼šåŒæ—¶è°ƒç”¨ï¼š
        â€¢	Basket æœåŠ¡ï¼šè¯»å–ç”¨æˆ·è´­ç‰©è½¦
        â€¢	Catalog æœåŠ¡ï¼šç¡®è®¤å•†å“ä»·æ ¼ä¸ä¿¡æ¯
        â€¢	Discount æœåŠ¡ï¼šè®¡ç®—åº”ä»˜é‡‘é¢

    ç”¨æˆ·ä¸‹å•çš„å®Œæ•´è°ƒç”¨é“¾ä¸ºï¼š
        1.	å‰ç«¯å±•ç¤ºå•†å“ â†’ è°ƒç”¨ Catalog.API
        2.	ç”¨æˆ·åŠ è´­å•†å“ â†’ è°ƒç”¨ Basket
        3.	ç”¨æˆ·ä½¿ç”¨ä¼˜æƒ åˆ¸ â†’ è°ƒç”¨ Discount
        4.	æäº¤è®¢å• â†’ Ordering æ”¶é›†è´­ç‰©è½¦ + è°ƒç”¨æŠ˜æ‰£ + è°ƒç”¨ Catalog â†’ æœ€ç»ˆç”Ÿæˆè®¢å•



Catalogçš„å¼€å‘æ­¥éª¤
    ç»“æ„
        controller
            productsController.cs//æ§åˆ¶å™¨ï¼Œå¤„ç†APIè¯·æ±‚
        data
            CatalogContext.cs //æ•°æ®ï¼ŒåŒ…å«DbContext
        models
            Product.cs
        Migrations// EF Core æ•°æ®è¿ç§»è‡ªåŠ¨ç”Ÿæˆ
        program.cs//åº”ç”¨å…¥å£ï¼Œé…ç½®ä¸­é—´ä»¶ï¼ŒæœåŠ¡æ³¨å†Œ
        appsetting.json//é…ç½®æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ä¿¡æ¯
1. åˆ›å»ºé¡¹ç›®
    dotnet new webapi -n Catalog.API
    cd Catalog.API
2. æ·»åŠ å¿…è¦ä¾èµ–
    dotnet add package Microsoft.EntityFrameworkCore
    dotnet add package Microsoft.EntityFrameworkCore.Design
    dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL
3.å®šä¹‰æ¨¡å‹ï¼ŒModels/Product.cs
    public class Product
    {
        public int Id { get; set; }
        public string Name { get; set; } = string.Empty;
        public string Description { get; set; } = string.Empty;
        public decimal Price { get; set; }
    }
4.é…ç½® DbContextï¼ŒData/CatalogContext.cs
    public class CatalogContext : DbContext
    {
        public CatalogContext(DbContextOptions<CatalogContext> options) : base(options) {}
        public DbSet<Product> Products { get; set; }
    }
5.é…ç½®æœåŠ¡Program.cs
    builder.Services.AddDbContext<CatalogContext>(options =>
        options.UseNpgsql(builder.Configuration.GetConnectionString("CatalogConnection")));

    builder.Services.AddControllers();
    builder.Services.AddEndpointsApiExplorer();
    builder.Services.AddSwaggerGen();
6.appsettings.json æ·»åŠ è¿æ¥å­—ç¬¦ä¸²ï¼š
    "ConnectionStrings": {
    "CatalogConnection": "Host=localhost;Port=5432;Database=CatalogDB;Username=postgres;Password=your_password"
    }
7. æ•°æ®åº“è¿ç§»ä¸ç”Ÿæˆ(æ­¤æ­¥éª¤ä¼šåœ¨ PostgreSQL ä¸­åˆ›å»º CatalogDB æ•°æ®åº“å’Œ Products è¡¨)
    dotnet ef migrations add InitialCreate
    dotnet ef database update
8. åˆ›å»ºæ§åˆ¶å™¨ï¼ˆCRUDï¼‰Controllers/ProductsController.cs
	â€¢	GET /api/products
	â€¢	GET /api/products/{id}
	â€¢	POST /api/products
	â€¢	PUT /api/products/{id}
	â€¢	DELETE /api/products/{id}
9. å¯ç”¨ Swagger & å¯åŠ¨é¡¹ç›®
    if (app.Environment.IsDevelopment())
    {
        app.UseSwagger();
        app.UseSwaggerUI();
    }
10.è¿è¡Œé¡¹ç›®
    dotnet run


è¯­æ³•
    [HttpXXX] // è¯·æ±‚ç±»å‹ï¼Œå¦‚ HttpGet, HttpPost ç­‰
    public ActionResult<è¿”å›ç±»å‹> æ–¹æ³•å(å‚æ•°)
    {
        // é€»è¾‘å¤„ç†
        return Ok(è¿”å›å†…å®¹);
    }
    ğŸ” æ·»åŠ ä¾èµ– âœ é…ç½® appsettings âœ åˆ›å»º DbContext + æ¨¡å‹ âœ æ³¨å†ŒæœåŠ¡ âœ æ§åˆ¶å™¨è°ƒç”¨


Basketå¼€å‘
    Basket.API/
    â”‚
    â”œâ”€â”€ appsettings.json           â¬… Redis åœ°å€é…ç½®
    â”œâ”€â”€ Program.cs                 â¬… æ³¨å†Œ Redis + Repository
    â”œâ”€â”€ Models/
    â”‚   â”œâ”€â”€ ShoppingCart.cs        â¬… ç”¨æˆ·è´­ç‰©è½¦ç»“æ„
    â”‚   â””â”€â”€ ShoppingCartItem.cs    â¬… è´­ç‰©è½¦å†…å•†å“ç»“æ„
    â”‚
    â”œâ”€â”€ Data/
    â”‚   â”œâ”€â”€ IBasketRepository.cs   â¬… æ¥å£å®šä¹‰
    â”‚   â””â”€â”€ BasketRepository.cs    â¬… Redis å®ç°
    â”‚
    â””â”€â”€ Controllers/
        â””â”€â”€ BasketController.cs    â¬… API å…¥å£

1. åˆ›å»ºä¸€ä¸ªæ–°çš„ Web API é¡¹ç›®
    dotnet new webapi -n Basket.API
    cd Basket.API
2. æ·»åŠ å¿…è¦ä¾èµ–
    dotnet add package StackExchange.Redis
    dotnet add package Swashbuckle.AspNetCore
3. å®šä¹‰æ¨¡å‹ï¼ŒModels
    å†™shoppingCartitem.cs
    å†™ShoppingCart.cs
4. ç”¨ Redis æ¥å­˜å‚¨ Basketï¼ˆè´­ç‰©è½¦ï¼‰æœåŠ¡çš„æ•°æ®ï¼Œå°±ä¸æ¶‰åŠåˆ°å¯¹DbContextçš„ä½¿ç”¨äº†
    1. åœ¨Basket.API.csprojæ·»åŠ 
        <PackageReference Include="StackExchange.Redis" Version="2.6.122" />
    2.å®‰è£…
        dotnet add package StackExchange.Redis
    3.appsettings.json é…ç½® Redis è¿æ¥å­—ç¬¦ä¸²
        {
            "ConnectionStrings": {
                "Redis": "localhost:6379"  // å¦‚æœä½ æ˜¯ç”¨ Dockerï¼Œåˆ™æ›¿æ¢ä¸ºå®¹å™¨å
            }
        }
    4.æ³¨å†Œ Redis æœåŠ¡ä¸ Repository åœ¨Program.cs ä¸­æ·»åŠ ï¼š
        using StackExchange.Redis;
        using Basket.API.Data;

        builder.Services.AddSingleton<IConnectionMultiplexer>(sp =>
            ConnectionMultiplexer.Connect(builder.Configuration.GetConnectionString("Redis")!)
        );

        builder.Services.AddScoped<IBasketRepository, BasketRepository>();
    5.å®šä¹‰æ¥å£ Data/IBasketRepository.cs
        public interface IBasketRepository
        {
            Task<ShoppingCart?> GetBasketAsync(string username);
            Task<ShoppingCart> UpdateBasketAsync(ShoppingCart basket);
            Task DeleteBasketAsync(string username);
        }
    6.Data/BasketRepository.cs
        public class BasketRepository : IBasketRepository
        {
            private readonly IDatabase _database;

            public BasketRepository(IConnectionMultiplexer redis)
            {
                _database = redis.GetDatabase();
            }

            public async Task<ShoppingCart?> GetBasketAsync(string username)
            {
                var basketData = await _database.StringGetAsync(username);
                if (basketData.IsNullOrEmpty) return null;
                return JsonSerializer.Deserialize<ShoppingCart>(basketData!);
            }

            public async Task<ShoppingCart> UpdateBasketAsync(ShoppingCart basket)
            {
                var updated = await _database.StringSetAsync(
                    basket.Username,
                    JsonSerializer.Serialize(basket)
                );
                return updated ? basket : throw new Exception("Failed to save basket");
            }

            public async Task DeleteBasketAsync(string username)
            {
                await _database.KeyDeleteAsync(username);
            }
        }
    7.Modelsçš„å¼€å‘-> Controllers å¼€å‘ -> Program.cs æ³¨å†Œ




Orderingå¼€å‘
    Ordering.API/
    â”‚
    â”œâ”€â”€ appsettings.json           â¬… Redis åœ°å€é…ç½®
    â”œâ”€â”€ Program.cs                 â¬… æ³¨å†Œ Redis + Repository
    â”œâ”€â”€ Models/
    â”‚   â”œâ”€â”€         â¬… ç”¨æˆ·è´­ç‰©è½¦ç»“æ„
    â”‚   â””â”€â”€     â¬… è´­ç‰©è½¦å†…å•†å“ç»“æ„
    â”‚
    â”œâ”€â”€ Data/
    â”‚   â”œâ”€â”€    â¬… æ¥å£å®šä¹‰
    â”‚   â””â”€â”€     â¬… Redis å®ç°
    â”‚
    â””â”€â”€ Controllers/
        â””â”€â”€     â¬… API å…¥å£

1. åˆ›å»ºä¸€ä¸ªæ–°çš„ Web API é¡¹ç›®
    dotnet new webapi -n Ordering.API
    cd Ordering.API

2. åˆ›å»ºæ–‡ä»¶å¤¹
    mkdir Controllers
    mkdir Data
    mkdir Models

3. æ·»åŠ å¿…è¦ä¾èµ–
    æ•°æ®åº“æ”¯æŒ
    dotnet add package Microsoft.EntityFrameworkCore
    dotnet add package Microsoft.EntityFrameworkCore.Design
    dotnet add package Npgsql.EntityFrameworkCore.PostgreSQL
    Rabbit æ¶ˆæ¯é˜Ÿåˆ—
    dotnet add package MassTransit
    dotnet add package MassTransit.AspNetCore
    dotnet add package MassTransit.RabbitMQ

4. åˆ›å»º OrderItem.cs -> Order.cs 